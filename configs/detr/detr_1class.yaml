experiment:
  name: detr_tomato_1class_exp001
  seed: 42
  save_dir: exp
  log_image_enabled: true
  log_image_interval: 5

model:
  arch_name: detr
  pretrained_path: facebook/detr-resnet-50
  num_labels: 1
  score_threshold: 0.5
  # Optimizer settings
  learning_rate: 0.0001
  lr_backbone: 0.00001
  weight_decay: 0.0001
  # Detection settings
  num_queries: 100
  bbox_loss_coef: 5.0
  giou_loss_coef: 2.0
  class_loss_coef: 1.0
  # Architecture details (선택사항)
  hidden_dim: 256
  nheads: 8
  num_encoder_layers: 6
  num_decoder_layers: 6
  dim_feedforward: 2048
  dropout: 0.1

data:
  dataset_name: TomatOD_COCO_1
  num_classes: 1
  class_names:
    - tomato

  # Paths
  data_root: data/TomatOD_COCO_1
  train_dir: data/TomatOD_COCO_1/train
  val_dir: data/TomatOD_COCO_1/val
  test_dir: data/TomatOD_COCO_1/test

  # Annotations
  train_ann_file: custom_train.json
  val_ann_file: custom_val.json
  test_ann_file: custom_test.json

  # DataLoader settings
  batch_size: 8
  num_workers: 0
  pin_memory: true

  # Image preprocessing
  image_size: 800
  
  # Data augmentation
  use_augmentation: true
  augmentation:
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
      hue: 0.05
    sharpness:
      factor: 1.5
      prob: 0.2

trainer:
  max_epochs: 100
  accelerator: gpu
  devices: 1
  precision: 16-mixed
  enable_progress_bar: true
  log_every_n_steps: 10
  val_check_interval: 1.0
  check_val_every_n_epoch: 1
  # Gradient settings
  accumulate_grad_batches: 4
  gradient_clip_val: 0.1
  gradient_clip_algorithm: norm
  # Callbacks
  early_stopping:
    monitor: val_loss
    patience: 20
    mode: min
  checkpoint:
    monitor: val_loss
    mode: min
    save_top_k: 3
    save_last: true
    filename: best-{epoch:02d}-{val_loss:.2f}
    auto_insert_metric_name: false

evaluation:
  score_threshold: 0.5
  iou_threshold: 0.5
  nms_threshold: 0.5
  max_detections: 100
  metrics:
    - map
    - map_50
    - map_75
    - mar_1
    - mar_10
    - mar_100

logging:
  tensorboard:
    enabled: true
    log_graph: false
  csv:
    enabled: true
  wandb:
    enabled: false
    project: tomato-detection
    entity: null

hardware:
  device: cuda
  amp_enabled: true
  cudnn_benchmark: true
  deterministic: false